<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="Borrow">
  
	<!-- 전체 검색 지역 & 타이틀 & 내용 -->
	<select id="toSearch" resultType="kh.spring.dto.BorrowDTO">
		<![CDATA[select * from (select rownum as rnum, A.* from (select * from borrowboard where address1 like '%'||#{search}||'%' or title like '%'||#{search}||'%' or contents like '%'||#{search}||'%' order by seq desc) A where ROWNUM <= #{endNum}) where rnum >= #{startNum}]]>
	</select>
	
	<!-- 카테고리 검색 -->
	<select id="toCategory" resultType="kh.spring.dto.BorrowDTO">
		<![CDATA[select * from (select rownum as rnum, A.* from (select * from borrowboard where #{category} like '%'||#{search}||'%' order by seq desc) A where ROWNUM <= #{endNum}) where rnum >= #{startNum}]]>
	</select>
	
	<!-- 검색이 null일 경우 전체목록 나오게 -->
	<select id="toList" resultType="kh.spring.dto.BorrowDTO">
		<![CDATA[select * from (select rownum as rnum, A.* from (select * from borrowboard order by seq desc) A where ROWNUM <= #{endNum}) where rnum >= #{startNum}]]>
	</select>
		
	<!-- 검색 지역 & 타이틀 & 컨텐츠 카운트 -->
	<select id="allList" resultType="int">
		select count(*) from borrowboard
	</select>
	
	<!-- 검색 지역 & 타이틀 & 컨텐츠 카운트 -->
	<select id="searchList" resultType="int">
		select count(*) from borrowboard where address1 like '%'||#{value}||'%' or title like '%'||#{value}||'%' or contents like '%'||#{value}||'%'
	</select>
	
</mapper>